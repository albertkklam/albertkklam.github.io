<!DOCTYPE html>
<html lang="en-us">
    <head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<title>All You Can Eat &middot; verbose: 1</title>

		
  		<link rel="stylesheet" href="/css/style.css">
		<link rel="stylesheet" href="/css/fonts.css">
		<link rel="stylesheet" href="/css/theorems.css">
		
		<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
		<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
		<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

		
		<link href="" rel="alternate" type="application/rss+xml" title="verbose: 1" />

		
		<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
  });
  MathJax.Hub.Queue(function() {
    
    
    
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });

  MathJax.Hub.Config({
  
  TeX: { equationNumbers: { autoNumber: "AMS" } }
  });
</script>

	</head>

    <body>
        <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">

<link href="/css/dark-mode.css" rel="stylesheet">
		<nav class="nav">
			<div class="nav-container">
				<a href="/">
					<h2 class="nav-title">verbose: 1</h2>
				</a>
				<ul>
    
    
        <li>
            <a href="/posts/">
                
                <span>Blog</span>
                
            </a>
        </li>
    
        <li>
            <a href="/books/">
                
                <span>Books</span>
                
            </a>
        </li>
    
        <li>
            <a href="/about/">
                
                <span>About</span>
                
            </a>
        </li>
    
</ul>
				    <div class="js-toggle-wrapper">
        <div class="js-toggle">
            <div class="js-toggle-track">
                <div class="js-toggle-track-check">
                    <img src="data:image/png;base64,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" role="presentation" style="pointer-events: none;" width="16" height="16">
                </div>
                <div class="js-toggle-track-x">
                    <img src="data:image/png;base64,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" role="presentation" style="pointer-events: none;" width="16" height="16">
                </div>
            </div>
            <div class="js-toggle-thumb"></div>
            <input class="js-toggle-screenreader-only" type="checkbox" aria-label="Switch between Dark and Light mode">
        </div>
    </div>

    <style>
         
        
        .js-toggle-wrapper {
            display: table;
            margin: 0 auto;
        }
        
        .js-toggle {
            touch-action: pan-x;
            display: inline-block;
            position: relative;
            cursor: pointer;
            background-color: transparent;
            border: 0;
            padding: 0;
            -webkit-touch-callout: none;
            user-select: none;
            -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
            -webkit-tap-highlight-color: transparent;
        }
        
        .js-toggle-screenreader-only {
            border: 0;
            clip: rect(0 0 0 0);
            height: 1px;
            margin: -1px;
            overflow: hidden;
            padding: 0;
            position: absolute;
            width: 1px;
        }
        
        .js-toggle-track {
            width: 50px;
            height: 24px;
            padding: 0;
            border-radius: 30px;
            background-color: hsl(222, 14%, 7%);
            transition: all 0.2s ease;
        }
        
        .js-toggle-track-check {
            position: absolute;
            width: 17px;
            height: 17px;
            left: 5px;
            top: 0px;
            bottom: 0px;
            margin-top: auto;
            margin-bottom: auto;
            line-height: 0;
            opacity: 0;
            transition: opacity 0.25s ease;
        }
        
        .js-toggle--checked .js-toggle-track-check {
            opacity: 1;
            transition: opacity 0.25s ease;
        }
        
        .js-toggle-track-x {
            position: absolute;
            width: 17px;
            height: 17px;
            right: 5px;
            top: 0px;
            bottom: 0px;
            margin-top: auto;
            margin-bottom: auto;
            line-height: 0;
            opacity: 1;
            transition: opacity 0.25s ease;
        }
        
        .js-toggle--checked .js-toggle-track-x {
            opacity: 0;
        }
        
        .js-toggle-thumb {
            position: absolute;
            top: 1px;
            left: 1px;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            background-color: #fafafa;
            box-sizing: border-box;
            transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1) 0ms;
            transform: translateX(0);
        }
        
        .js-toggle--checked .js-toggle-thumb {
            transform: translateX(26px);
            border-color: #19ab27;
        }
        
        .js-toggle--focus .js-toggle-thumb {
            box-shadow: 0px 0px 2px 3px rgb(255, 167, 196);
        }
        
        .js-toggle:active .js-toggle-thumb {
            box-shadow: 0px 0px 5px 5px rgb(255, 167, 196);
        }

    </style>

    <script>
        var body = document.body;
        var switcher = document.getElementsByClassName('js-toggle')[0];

        
        switcher.addEventListener("click", function() {
            this.classList.toggle('js-toggle--checked');
            this.classList.add('js-toggle--focus');
            
            if (this.classList.contains('js-toggle--checked')) {
                body.classList.add('dark-mode');
                
                localStorage.setItem('darkMode', 'true');
            } else {
                body.classList.remove('dark-mode');
                setTimeout(function() {
                    localStorage.removeItem('darkMode');
                }, 100);
            }
        })

        
        if (localStorage.getItem('darkMode')) {
            
            switcher.classList.add('js-toggle--checked');
            body.classList.add('dark-mode');
        }

    </script>

			</div>
		</nav>

        

<main>
	<div class="post">
		<div class="post-info">
    <span>Written by</span>
        Albert Lam
        <br>
        <span>on&nbsp;</span><time datetime="2019-06-24 00:00:00 &#43;0000 UTC">June 24, 2019</time>
</div>
		<h1 class="post-title">All You Can Eat</h1>
<div class="post-line"></div>

		

		<h2 id="the-arxiv-book-club">The arXiv Book Club</h2>
<p>A few friends and I started a reading group earlier this month since we&rsquo;re all hanging out in Chicago over the summer. This is the first of (hopefully) many posts related to various topics we cover over the next few months. Our entree (this post) summarises the theoretical results from the seminal paper on the Indian Buffet Process by <a href="http://www.jmlr.org/papers/volume12/griffiths11a/griffiths11a.pdf">Griffiths and Ghahramani (2011)</a>.</p>
<h2 id="preliminaries">Preliminaries</h2>
<p>For random variables $A$ and $B$, <strong>Bayes' rule</strong> gives us</p>
<p>$$
\begin{align}
P(B \mid A) &amp;= \frac{P(B \cap A)}{P(A)} \nonumber \newline
&amp;= \frac{P(A \mid B) \cdot P(B)}{P(A)} \label{bayesrule}
\end{align}
$$</p>
<p>Now, suppose we have some hypothetical distribution $X$ from which data can be drawn from, and some hypothetical distribution $\theta$ from which the parameters of $X$ can be drawn from. Then, a natural problem is to find the value(s) of $\theta$ that best explains the observed data from $X$. Applying Bayes' rule from $\eqref{bayesrule}$ is one approach</p>
<p>$$
\begin{align}
P(\theta \mid X) &amp;= \frac{P(X \mid \theta) \cdot P(\theta)}{P(X)} \nonumber \newline
&amp;\propto P(X \mid \theta) \cdot P(\theta) \nonumber
\end{align}
$$</p>
<p>Here, $P(\theta)$ is called the <strong>prior</strong> distribution of $\theta$, which represents the distribution of $\theta$ values before any data is observed, $P(X \mid \theta)$ is the <strong>likelihood</strong>, which represents how likely we are of observing the current instance of $X$ given the $\theta$ parameter values, and $P(X)$ is the likelihood marginalised over all possible $\theta$ values. Bayes' rule tells us that we can update the prior of $\theta$ using observations from $X$ so that our belief in the value of $\theta$ reflects the information we currently have &ndash; we call this updated distribution $P(\theta \mid X)$ the <strong>posterior</strong> distribution of $\theta$.</p>
<h2 id="motivating-infinite-mixture-models">Motivating infinite mixture models</h2>
<p>We will consider a simple example to make some of these ideas more concrete. Suppose we are the owners of a supermarket and we are interested in better understanding the different types of customers that shop in our store. We have access to the purchasing history of each customer, including information such as which items they purchase, at what price they purchase them at, when they purchase those items, and how many they purchase at one time. We want to use this data to infer attributes of each customer that are naturally unknown, such as their price elasticity, whether they live by themselves or as part of a large family, and whether they are young or old. The intention is to use these attributes to improve store-level operations and ensure customer satisfaction remains high.</p>
<p>This example is a classic unsupervised learning problem, where each customer represents an observation, their purchasing history can be summarized as observable features associated with each observation, and we want to make a prediction that classifies each observation into some unobservable customer-type category. In the literature, the hidden customer category is more generally referred to as a <strong>latent variable</strong> (or latent feature) in such models, and each category itself is referred to as a <strong>class</strong> of that latent variable.</p>
<p>One key problem here is determining a reasonable form to this latent structure, such as the number of possible customer types, and is often resolved by assuming there is a unique, finite number of classes that correctly characterises what is observed. Alternatively, we can instead assume that the correct representation of the latent structure is potentially unbounded, or &ldquo;infinite&rdquo; in the number of customer types &ndash; although this is in actual fact bounded by the number of unique customers we observe. The benefit here is that there is no need to define an additional hyperparameter for how many ground-truth classes should exist in our sample, which without first analysing the data seems rather contrived. This family of models is central to the study of <strong>nonparametric Bayesian statistics</strong>, where nonparametric refers to the fact that these models have potentially an infinite number of parameters.</p>
<p>The Dirichlet process mixture model (DP) is one such example in this family, where each customer is assigned to one customer-type category, and each category is associated with a distribution over some set of observable properties, such as average price per item or average elapsed time since last purchase. While the Dirichlet process is nonparametric, it is somewhat unnatural to think of customers as being solely associated with one class from the set of all possible classes. Rather, it would seem more appropriate that our customers are multi-faceted and their observed behaviour is a result from multiple causes. The <strong>Indian buffet process (IBP)</strong> is a generative approach that is primarily motivated by the DP model, but considers customers (observations) as combinations of (possessing) causes or drivers (features) that are potentially infinite in number.</p>
<h2 id="extending-finite-mixture-models">Extending finite mixture models&hellip;</h2>
<p>We begin by first reviewing the construction of finite mixture models, which will motivate the construction of infinite mixture models. Suppose we have $N$ observations $x_1, \dots, x_N$, where each $x_i \in \mathbb{R}^{D}$ is a vector of $D$ observable properties for $i = 1, \dots, N$. Then, let $X = \left[ x_1^\intercal, \dots, x_N^\intercal \right]^\intercal$ be the $N \times D$ data matrix, and let the vector $c = \left[ c_1, \dots, c_N \right]^\intercal \in {1, \dots, K}^{N}$ indicate the class assignments of the $N$ observations. Following the definitions from earlier, $P(c)$ is the <strong>assignment prior</strong> and specifies the number of classes and their relative probabilities, and $P(X \mid c)$ is the likelihood which determines how classes relate to the observable properties in $X$. Assuming that the assignment of an observation to a class is independent of the assignment of other observations, if there are $K$ classes and $\theta = \left[\theta_1, \dots, \theta_K \right]^\intercal$ is the vector of parameters for $c$, we can write the distribution of classes over $\theta$ as</p>
<p>$$
\begin{align}
P(c \mid \theta) &amp;= \prod_{i=1}^{N} P(c_i = k \mid \theta) \nonumber \newline
&amp;= \prod_{i=1}^{N} \theta_{k} \label{thetadist}
\end{align}
$$</p>
<p>where $\theta_{k}$ can be interpreted as the probability of assigning an observation to class $k$ given $\theta$, and it follows that $c \mid \theta \sim Multinomial(N, \theta_1, \dots, \theta_K)$. Then, using $\eqref{thetadist}$, we can write the likelihood as</p>
<p>$$
\begin{align}
P(X \mid c) &amp;= \prod_{i=1}^{N} P(x_i \mid c_i, \theta) \nonumber \newline
&amp;= \prod_{i=1}^{N} \sum_{k=1}^{K} P(x_i \mid c_i = k) \cdot P(c_i = k \mid \theta) \nonumber \newline
&amp;= \prod_{i=1}^{N} \sum_{k=1}^{K} P(x_i \mid c_i = k) \cdot \theta_{k} \nonumber
\end{align}
$$</p>
<p>The likelihood is thus a finite mixture model with $K$ classes and weights $\theta_k$ that themselves can be treated as parameters that need to be estimated. One common choice is to let $\theta \mid \alpha \sim Dirichlet(K, \alpha_1, \dots, \alpha_K)$, and setting $\alpha_1 = \alpha_2 = \dots = \alpha_K = \frac{\alpha}{K}$. The <strong>complete finite mixture model</strong> is then</p>
<p>$$
\begin{align}
\theta &amp;\mid \alpha \sim Dirichlet \left(K, \frac{\alpha}{K}, \dots, \frac{\alpha}{K} \right) \nonumber \newline
c &amp;\mid \theta \sim Multinomial(N, \theta_1, \dots, \theta_K) \nonumber
\end{align}
$$</p>
<p>Marginalising $\theta$, we can express the assignment prior as</p>
<p>$$
\begin{align}
P(c) &amp;= \int_{\Theta} \prod_{i=1}^{N} P(c_i \mid \theta) \cdot P(\theta) \quad d\theta \label{thetamarg1} \newline
&amp;= \int_{\Theta} \frac{1}{D\left(\frac{\alpha}{K}, \dots, \frac{\alpha}{K} \right)} \prod_{k=1}^{K} \theta_{k}^{m_k + \frac{\alpha}{K} - 1} \quad d\theta \label{thetamarg2} \newline
&amp;= \frac{D\left(m_1 + \frac{\alpha}{K}, \dots, m_K + \frac{\alpha}{K} \right)}{D\left(\frac{\alpha}{K}, \dots, \frac{\alpha}{K} \right)} \label{thetamarg3} \newline
&amp;= \frac{\prod_{k=1}^{K} \Gamma\left(m_k + \frac{\alpha}{K}\right)}{\left[\Gamma \left(\frac{\alpha}{K} \right)\right]^{K}} \cdot \frac{\Gamma(\alpha)}{\Gamma(N + \alpha)} \label{thetamarg4}
\end{align}
$$</p>
<p>where $m_k = \sum_{i=1}^{N} \delta(c_i = k)$ is the number of observations assigned to class $k$, and $D\left(\alpha_1, \dots, \alpha_K \right) = \frac{\prod_{k=1}^{K} \Gamma(\alpha_k)}{\Gamma(\sum_{k=1}^{K} \alpha_k)}$ is the normalising constant in a Dirichlet distribution with parameters $\alpha_1, \dots, \alpha_K$. Here, $\eqref{thetamarg1}$ follows from the law of total probability, $\eqref{thetamarg2}$ follows from combining the density functions of the Dirichlet and multinomial distributions, and $\eqref{thetamarg3}$ and $\eqref{thetamarg4}$ follow from simplifying the resulting expression.</p>
<h2 id="-to-infinity">&hellip; to infinity</h2>
<p>In order to replicate the same derivations for the infinite case, we make use of the recursive identity of the gamma function</p>
<p>$$
\begin{align}
\Gamma(x) &amp;= (x-1) \cdot \Gamma(x-1) \label{gammarec}
\end{align}
$$</p>
<p>Applying $\eqref{gammarec}$ to $\eqref{thetamarg4}$, we can write the assignment prior as</p>
<p>$$
\begin{align}
P(c) &amp;= \frac{\prod_{k=1}^{K} \prod_{j=1}^{m_k - 1} \left(j + \frac{\alpha}{K} \right) \cdot \Gamma \left(\frac{\alpha}{K} + 1\right)}{\left[\Gamma \left(\frac{\alpha}{K} \right)\right]^{K}} \cdot \frac{\Gamma(\alpha)}{\Gamma(N + \alpha)} \nonumber \newline
&amp;= \frac{\left[\Gamma \left(\frac{\alpha}{K} + 1\right)\right]^{K_+}}{\left[\Gamma \left(\frac{\alpha}{K} \right)\right]^{K}} \left( \prod_{k=1}^{K_+} \prod_{j=1}^{m_k - 1} \left(j + \frac{\alpha}{K} \right) \right) \frac{\Gamma(\alpha)}{\Gamma(N + \alpha)} \nonumber \newline
&amp;= \left(\frac{\alpha}{K} \right)^{K_+} \left(\prod_{k=1}^{K_+} \prod_{j=1}^{m_k - 1} \left(j + \frac{\alpha}{K} \right) \right) \frac{\Gamma(\alpha)}{\Gamma(N + \alpha)} \label{assignprior}
\end{align}
$$</p>
<p>where $K_+$ is the number of classes for which $m_k &gt; 0$, and the indices of $m_k$ are reordered so that $m_k &gt; 0$ for all $k &lt; K_+$. Note that this does not affect the assignment prior, which is invariant to permutations of the observation order &ndash; this property is known as <strong>exchangeability</strong>. Now, observe that there are $K^{N}$ possible values for $c$, which diverges as $K \rightarrow \infty$, and thus the probability of observing any single instance assignment vector goes to 0. This motivates the consideration of modelling the distribution over <strong>equivalence classes</strong>, rather than the actual assignment vectors themselves. We explore these concepts next.</p>
<p>A <strong>partition</strong> is a division of a set of $N$ observations into subsets, such that each observation only belongs to one subset and the ordering of the subsets do not matter. Thus, two assignment vectors that result in the same division of observations correspond to the same partition. A partition therefore defines an equivalence class $[c]$ for assignment vectors $c$, where two assignment vectors belong to the same equivalence class if they correspond to the same partition. Suppose we partition $N$ observations into $K_+$ subsets, and we have $K = K_0 + K_+$ class labels that can be applied to these subsets. Then, there are $\binom{K}{K_+} \times K_+! = \frac{K!}{K_0!}$ assignment vectors that belong to the equivalence class defined by that partition, and we can define a probability <strong>distribution over partitions</strong> by summing over all assignment vectors that belong to that class. Using the results from $\eqref{assignprior}$ and taking the limit gives us</p>
<p>$$
\begin{align}
P([c]) &amp;= \sum_{c \in [c]} P(c) \nonumber \newline
&amp;= \frac{K!}{K_0!} \left(\frac{\alpha}{K} \right)^{K_+} \left(\prod_{k=1}^{K_+} \prod_{j=1}^{m_k - 1} \left(j + \frac{\alpha}{K} \right) \right)  \frac{\Gamma(\alpha)}{\Gamma(N + \alpha)} \nonumber \newline
\lim_{K \rightarrow \infty} P([c]) &amp;= \alpha^{K_+} \left(\prod_{k=1}^{K_+} (m_k - 1)! \right) \frac{\Gamma(\alpha)}{\Gamma(N + \alpha)} \label{partprior} \newline
\end{align}
$$</p>
<p>Thus, we have a valid distribution over partitions, and thus over equivalence classes of assignment vectors, which provides an assignment prior for an infinite mixture model. Like the assignment prior from the finite mixture model, the distribution of the assignment prior here satisfies exchangeability.</p>
<h2 id="arbitrarily-large-tables">Arbitrarily large tables</h2>
<p>A <strong>Chinese restaurant process (CRP)</strong> is an analogous formulation of our &ldquo;distribution over partitions&rdquo; described above. Imagine a restaurant with an infinite number of tables, and an infinite number of chairs at each table. As customers enter the restaurant, they choose an already occupied table with probability proportional to the number of people already at the table, or chooses the next vacant table with probability proportional to parameter $\alpha$. It follows that customer $c_i$ would be assigned to table $k$ with probability</p>
<p>$$
\begin{align}
P(c_i = k \mid c_1, \dots, c_{i-1}) &amp;= \begin{cases}
\frac{m_k}{i - 1 + \alpha} \quad &amp;\text{if} \quad k &lt; K_+ \newline
\frac{\alpha}{i - 1 + \alpha} \quad &amp;\text{if} \quad k = K + 1
\end{cases}
\nonumber
\end{align}
$$</p>
<p>The assignment of all customers (observations) to tables (classes) via this process produces a distribution over partitions of the same form as $\eqref{partprior}$. The elegance of the CRP is that it provides an intuitive way for generating assignment priors for an infinite mixture model.</p>
<h2 id="connections-to-latent-feature-models">Connections to latent feature models</h2>
<p>We now have the tools for representing observations in terms of infinitely many latent features. In a <strong>latent feature model</strong>, each observation $c_i$ is represented by a vector of latent feature values $f_i \in \mathbb{R}^{K}$, and the observable properties $x_i \in \mathbb{R}^{D}$ are generated from a distribution dependent on the $f_i$ vector. Let $F = [f_1^\intercal, \dots, f_N^\intercal]^\intercal$ be the $N \times K$ matrix of latent features for all $N$ observations, with prior $P(F)$ and likelihood $P(X \mid F)$. Then, $F$ can be expressed as the elementwise (Hadamard) product of two matrices $Z$ and $V$, where $Z \in \mathbb{R}^{N \times K}$ is a <strong>binary matrix</strong> for whether observation $i$ has feature $k$, and $V \in \mathbb{R}^{N \times K}$ is a <strong>matrix of feature values</strong> for each observation. The prior on $F$ can then be defined by specifying priors on $Z$ and $V$, with $p(F) = p(Z) \cdot p(V)$. If $Z$ is sparse, we can define a prior for infinite latent feature models by defining a distribution over infinite binary matrices. Our analysis suggests that such a distribution should satisfy exchangeability, and this can be achieved by starting with a model that assumes a finite number of features, and then taking the limit.</p>
<h2 id="from-a-la-carte">From a la carte&hellip;</h2>
<p>We begin in the same way as in our finite dimensional mixture model formulation by considering a finite latent feature model. Suppose we have $N$ observations and $K$ features, and the possession of feature $k$ by observation $i$ is indicated by a binary variable $z_{i,k}$, such that the values of $z_{i,k}$ form a $N \times K$ binary matrix $Z$. Assume observation $i$ possesses feature $k$ independently with probability $\pi_k$, where $0 \le \pi_k \le 1$. Then, let $\pi = [\pi_1, \dots, \pi_K]$ and we can write the likelihood as</p>
<p>$$
\begin{align}
P(Z \mid \pi) &amp;= \prod_{k=1}^{K} \prod_{i=1}^{N} P(z_{i,k} \mid \pi_k) \nonumber \newline
&amp;= \prod_{k=1}^{K} \pi_k^{m_k} (1 - \pi_k)^{N - m_k} \nonumber
\end{align}
$$</p>
<p>where $m_k = \sum_{i=1}^{N} z_{i,k}$ is the number of observations possessing feature $k$. Note that this is a Bernoulli likelihood with parameter $\pi_k$, and for the same reasons as we chose a Dirichlet distribution as the assignment prior in our latent class model, here we choose a <strong>feature prior</strong> that is beta distributed with parameters $\frac{\alpha}{K}$ and $1$</p>
<p>$$
\begin{align}
P(\pi_k) &amp;= \frac{\pi_k^{\frac{\alpha}{K}-1}}{B \left(\frac{\alpha}{K}, 1 \right)} \nonumber \newline
&amp;= \frac{\alpha}{K} \cdot \pi_k^{\frac{\alpha}{K}-1} \nonumber
\end{align}
$$</p>
<p>where $B(r,s) = \frac{\Gamma(r) \Gamma(s)}{\Gamma(r+s)}$ is the beta function. The <strong>complete finite feature model</strong> is then</p>
<p>$$
\begin{align}
\pi_k \mid \alpha &amp;\sim Beta \left( \frac{\alpha}{K}, 1 \right) \nonumber \newline
z_{i,k} \mid \pi_k &amp;\sim Bernoulli(\pi_k) \nonumber
\end{align}
$$</p>
<p>and the marginal distribution of $Z$ is</p>
<p>$$
\begin{align}
P(Z) &amp;= \prod_{k=1}^{K} \int_{\Pi} P(Z \mid \pi_k) P(\pi_k) \quad d\pi_k \label{zmarg1} \newline
&amp;= \prod_{k=1}^{K} \int_{\Pi} \left(\prod_{i=1}^{N} P(z_{i,k} \mid \pi_k) \right) P(\pi_k) \quad d\pi_k \label{zmarg2} \newline
&amp;= \prod_{k=1}^{K} \frac{B(m_k + \frac{\alpha}{K}, N - m_k + 1)}{B \left( \frac{\alpha}{K}, 1 \right)} \label{zmarg3} \newline
&amp;= \frac{\alpha}{K} \cdot \prod_{k=1}^{K} \frac{\Gamma \left(m_k + \frac{\alpha}{K} \right) \Gamma(N - m_k + 1)}{\Gamma \left( N + 1 + \frac{\alpha}{K} \right)} \label{zmarg4}
\end{align}
$$</p>
<p>Here, $\eqref{zmarg1}$ follows from the law of total probability, $\eqref{zmarg2}$ follows from independence of $z_{i,k} \mid \pi_k$, $\eqref{zmarg3}$ follows from combining the densities of beta and binomial distributions, and $\eqref{zmarg4}$ follows from the definition of the beta function. Note that $P(Z)$ satisfies exchangeability as desired.</p>
<h2 id="-to-all-you-can-eat">&hellip; to all you can eat</h2>
<p>The technical details of equivalence classes for binary matrices is omitted here for brevity &ndash; feel free to refer to section 4.2 of <a href="http://www.jmlr.org/papers/volume12/griffiths11a/griffiths11a.pdf">the paper</a> if you are interested. Instead, we simply define $[Z]$ as the equivalence class of binary matrix $Z$ and we can write</p>
<p>$$
\begin{align}
P([Z]) &amp;= \sum_{Z \in [Z]} P(Z) \nonumber \newline
&amp;= \frac{K!}{\prod_{h=0}^{2^{N}-1} K_{h}!} \prod_{k=1}^{K} \frac{\frac{\alpha}{K} \Gamma(m_k + \frac{\alpha}{K}) \Gamma(N - m_k + 1) }{\Gamma(N+1+\frac{\alpha}{K})} \label{equivZ1}
\end{align}
$$</p>
<p>Note that $\frac{K!}{\prod_{h=0}^{2^N-1} K_h!}$ is the cardinality of $[Z]$, where $K_h$ is the count of the number of columns with full <strong>history</strong> $h$ (see section 4.2 of the paper for details). Reordering the columns of $Z$ such that $m_k &gt; 0$ if $k \le K_+$, and $m_k = 0$ otherwise, we can write the product in $\eqref{equivZ1}$ as</p>
<p>$$
\begin{align}
&amp;\prod_{k=1}^{K} \frac{\frac{\alpha}{K} \Gamma(m_k + \frac{\alpha}{K}) \Gamma(N - m_k + 1) }{\Gamma(N+1+\frac{\alpha}{K})} \nonumber \newline
= \quad &amp; \left(\frac{\frac{\alpha}{K} \Gamma \left(\frac{\alpha}{K} \right) \Gamma(N+1)}{\Gamma \left( N + 1 + \frac{\alpha}{K} \right)} \right)^{K - K_+} \prod_{k=1}^{K_+} \frac{ \frac{\alpha}{K} \Gamma \left(m_k +\frac{\alpha}{K}\right) \Gamma(N - m_k + 1) }{\Gamma \left( N+1+\frac{\alpha}{K} \right)} \label{equivZ2} \newline
= \quad &amp; \left(\frac{\frac{\alpha}{K} \Gamma \left(\frac{\alpha}{K} \right) \Gamma(N+1)}{\Gamma \left( N + 1 + \frac{\alpha}{K} \right)} \right)^{K} \prod_{k=1}^{K_+} \frac{\Gamma \left(m_k +\frac{\alpha}{K}\right) \Gamma(N - m_k + 1) }{\Gamma \left( \frac{\alpha}{K} \right) \Gamma \left( N + 1 \right)} \label{equivZ3} \newline
= \quad &amp; \left( \frac{N!}{\prod_{j=1}^{N} \left( j + \frac{\alpha}{K} \right) } \right)^{K} \left(\frac{\alpha}{K} \right)^{K_+} \prod_{k=1}^{K_+} \frac{(N - m_k)! \prod_{j=1}^{m_k-1} \left(j + \frac{\alpha}{K} \right)}{N!} \label{equivZ4}
\end{align}
$$</p>
<p>Here, $\eqref{equivZ2}$ follows from applying the definition of the column reordering, $\eqref{equivZ3}$ follows from reordering the terms in the product, and $\eqref{equivZ4}$ follows from applying the recursive identity of the gamma function from $\eqref{gammarec}$. Substituting $\eqref{equivZ4}$ into $\eqref{equivZ1}$, and taking the limit gives us</p>
<p>$$
\begin{align}
&amp;\lim_{K \rightarrow \infty} P([Z]) \nonumber \newline
= \quad &amp; \frac{\alpha^{K_+}}{\prod_{h=1}^{2^{N}-1} K_{h}!} \cdot \exp \left\{-\alpha \sum_{j=1}^{N} \frac{1}{j} \right\} \cdot \prod_{k=1}^{K_+} \frac{(N - m_k)! (m_k - 1)!}{N!} \label{equivZ5}
\end{align}
$$</p>
<p>Again, this distribution satisfies exchangeability since neither the number of identical columns nor the column sums are affected by the ordering of observations.</p>
<h2 id="arbitrarily-large-plates">Arbitrarily large plates</h2>
<p>We are now ready to define the IBP, in much the same way as defined the CRP. Suppose we have $N$ customers enter a restaurant sequentially, and each customer encounters a buffer consisting of infinitely many dishes arranged in a line. The first customer starts at the beginning of the line and takes a serving from each dish, stopping after a $Poisson(\alpha)$ number of dishes are on their plate. The $i^{th}$ customer then moves along the buffet line and samples dishes according to their popularity $\frac{m_k}{i}$ where $m_k$ is the number of previous customers who sampled the dish. At the end of the line of previously sampled dishes, the $i^{th}$ customer samples $Poisson \left( \frac{\alpha}{i} \right)$ new dishes. We can record which customers sample which dishes using a binary matrix $Z$ with $N$ rows and infinitely many columns, where the entry in position $(i,k)$ is equal to $1$ if customer $i$ sampled dish $k$. Let $K_1^{(i)}$ indicate the number of newly sampled dishes by the $i^{th}$ customer, and the probability of any particular binary matrix being produced by this process is</p>
<p>$$
\begin{align}
P(Z) &amp;= \frac{\alpha^{K_+}}{\prod_{i=1}^{N} K_1^{(i)}! } \cdot \exp \left\{-\alpha \sum_{j=1}^{N} \frac{1}{j} \right\} \cdot \prod_{k=1}^{K_+} \frac{(N - m_k)! (m_k - 1)!}{N!} \nonumber
\end{align}
$$</p>
<p>and $\frac{\prod_{i=1}^{N} K_1!}{\prod_{h=0}^{2^{N}-1} K_{h}!}$ matrices generated by this process map to the same equivalence class, which gives us the exchangeable distribution $P([Z])$ from $\eqref{equivZ5}$. It is possible to directly produce the equivalence class distribution by considering the dishes with history $h$ &ndash; in the exchangeable IBP, the $i^{th}$ customer instead makes a single decision for each set of dishes with the same history. If there are $K_h$ dishes with history $h$ and $m_h$ previous customers have sampled each of these dishes, then the $i^{th}$ customer samples a $Binomial \left(\frac{m_h}{i}, K_h \right)$ number of those dishes before sampling $Poisson \left(\frac{\alpha}{i} \right)$ new dishes.</p>
<h2 id="tips-are-welcome">Tips are welcome!</h2>
<p><a href="http://www.jmlr.org/papers/volume12/griffiths11a/griffiths11a.pdf">Griffiths and Ghahramani (2011)</a> goes into further detail with examples (section 5), applications of the IBP approach (section 6), and concludes with a discussion on extensions to the IBP (section 7) and suggestions for future work (section 8). This post covers most of sections 1 through 4, with the exception of the derivation of Gibbs samplers for both the CRP and IBP (see sections 2.4 and 4.7 of the paper if you are interested). Thank you for bearing with all the food-related puns.</p>


		<div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "https-albertkklam-github-com" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
	</div>

	<div class="pagination">
		<a href="/posts/leastsquares/" class="left arrow">&#8592;</a>
		<a href="/posts/optmnfld/" class="right arrow">&#8594;</a>

		<a href="#" class="top">Top</a>
	</div>
</main>


        		<footer>
			<span>
			&copy; <time datetime="2022-01-01 00:01:44.09133 -0600 CST m=&#43;0.104973275">2022</time> Albert Lam. Made with <a href='https://gohugo.io'>Hugo</a> using the <a href='https://github.com/EmielH/tale-hugo/'>Tale</a> theme.
			</span>
		</footer>

    </body>
</html>
